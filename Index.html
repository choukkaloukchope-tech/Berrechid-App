<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¯Ù„ÙŠÙ„ Ø¨Ø±Ø´ÙŠØ¯</title>
  <style>
    body { font-family: 'Tahoma', sans-serif; margin:0; background:#f8f9fa; }
    header { background:#0077b6; color:white; padding:1rem; text-align:center; }
    nav { display:flex; flex-wrap:wrap; background:#0096c7; }
    nav button { flex:1; padding:0.8rem; border:none; background:#0096c7; color:white; cursor:pointer; }
    nav button:hover { background:#023e8a; }
    section { display:none; padding:1rem; }
    section.active { display:block; }
    .card { background:white; border-radius:8px; padding:1rem; margin:0.5rem 0; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .chat-widget { position:fixed; bottom:10px; left:10px; width:300px; background:white; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.2); }
    #chat-messages { max-height:200px; overflow-y:auto; padding:0.5rem; }
    #chat-input { width:70%; padding:0.5rem; }
    .admin-panel input, .admin-panel select { margin:0.3rem 0; padding:0.5rem; width:100%; }
    .notification { background:#ffd60a; padding:0.5rem; margin:0.5rem 0; border-radius:5px; }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ“Œ Ø¯Ù„ÙŠÙ„ Ø¨Ø±Ø´ÙŠØ¯</h1>
    <p>ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù…Ù† ØµÙŠØ¯Ù„ÙŠØ§ØªØŒ Ø³Ù†Ø§ÙƒØ§ØªØŒ Ø£Ø·Ø¨Ø§Ø¡ØŒ Ù†Ù‚Ù„...</p>
  </header>

  <nav>
    <button onclick="showSection('pharmacies')">ğŸ’Š ØµÙŠØ¯Ù„ÙŠØ§Øª</button>
    <button onclick="showSection('snacks')">ğŸ” Ø³Ù†Ø§ÙƒØ§Øª</button>
    <button onclick="showSection('shops')">ğŸª Ù…Ø­Ù„Ø§Øª</button>
    <button onclick="showSection('doctors')">ğŸ‘¨â€âš•ï¸ Ø£Ø·Ø¨Ø§Ø¡</button>
    <button onclick="showSection('transport')">ğŸš• Ø§Ù„Ù†Ù‚Ù„</button>
    <button onclick="showSection('train')">ğŸš† Ø§Ù„Ù‚Ø·Ø§Ø±Ø§Øª</button>
    <button onclick="showSection('admin')">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
  </nav>

  <!-- Ø§Ù„Ø£Ù‚Ø³Ø§Ù… -->
  <section id="pharmacies"></section>
  <section id="snacks"></section>
  <section id="shops"></section>
  <section id="doctors"></section>
  <section id="transport"></section>
  <section id="train"></section>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
  <section id="admin" class="admin-panel">
    <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
    <div id="notifications"></div>
    <select id="category">
      <option value="pharmacies">ØµÙŠØ¯Ù„ÙŠØ§Øª</option>
      <option value="snacks">Ø³Ù†Ø§ÙƒØ§Øª</option>
      <option value="shops">Ù…Ø­Ù„Ø§Øª</option>
      <option value="doctors">Ø£Ø·Ø¨Ø§Ø¡</option>
      <option value="transport">Ù†Ù‚Ù„</option>
      <option value="train">Ù‚Ø·Ø§Ø±Ø§Øª</option>
    </select>
    <input type="text" id="name" placeholder="Ø§Ù„Ø§Ø³Ù…"/>
    <input type="text" id="address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"/>
    <input type="text" id="phone" placeholder="Ø§Ù„Ù‡Ø§ØªÙ"/>
    <button onclick="addItem()">â• Ø¥Ø¶Ø§ÙØ©</button>
  </section>

  <!-- Chatbot -->
  <div class="chat-widget">
    <div id="chat-messages"></div>
    <input type="text" id="chat-input" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ..."/>
    <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>

<script>
  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
  let data = JSON.parse(localStorage.getItem("cityData")) || {
    pharmacies: [
      {name:"ØµÙŠØ¯Ù„ÙŠØ© Ø¨Ø±Ø´ÙŠØ¯", address:"Ù‚Ø±Ø¨ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰", phone:"0522334455"}
    ],
    snacks: [
      {name:"Ø³Ù†Ø§Ùƒ Ø§Ù„Ù…Ø°Ø§Ù‚", address:"Ø´Ø§Ø±Ø¹ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø®Ø§Ù…Ø³", phone:"0612345678"}
    ],
    shops: [
      {name:"Ù…Ø­Ù„ Ø§Ù„Ø£Ù…Ù„", address:"Ø³ÙˆÙ‚ Ø¨Ø±Ø´ÙŠØ¯", phone:"0600112233"}
    ],
    doctors: [
      {name:"Ø¯. Ø£Ø­Ù…Ø¯ - Ø·Ø¨ Ø¹Ø§Ù…", address:"Ù‚Ø±Ø¨ Ø§Ù„Ù…Ø­Ø·Ø©", phone:"0622334455"}
    ],
    transport: [
      {name:"Ø·Ø§ÙƒØ³ÙŠ ÙƒØ¨ÙŠØ±", address:"Ù…Ø­Ø·Ø© Ø§Ù„Ø·Ø§ÙƒØ³ÙŠØ§Øª", phone:"0677889900"}
    ],
    train: [
      {name:"Ù…Ø­Ø·Ø© Ø¨Ø±Ø´ÙŠØ¯", address:"ÙˆØ³Ø· Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", phone:"www.oncf.ma"}
    ]
  };

  // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
  function showSection(id){
    document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    renderSection(id);
  }

  // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  function renderSection(category){
    let section=document.getElementById(category);
    section.innerHTML="";
    data[category].forEach((item,i)=>{
      section.innerHTML+=`
        <div class="card">
          <h3>${item.name}</h3>
          <p>ğŸ“ ${item.address}</p>
          <p>ğŸ“ ${item.phone}</p>
        </div>`;
    });
  }

  // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯
  function addItem(){
    let cat=document.getElementById("category").value;
    let name=document.getElementById("name").value;
    let address=document.getElementById("address").value;
    let phone=document.getElementById("phone").value;
    data[cat].push({name,address,phone});
    localStorage.setItem("cityData",JSON.stringify(data));
    document.getElementById("notifications").innerHTML=`<div class="notification">âœ”ï¸ ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­</div>`;
    renderSection(cat);
  }

  // Chatbot Ù…Ø¹ OpenAI
  async function sendMessage(){
    let input=document.getElementById("chat-input").value;
    if(!input) return;
    document.getElementById("chat-messages").innerHTML+=`<p><b>Ø£Ù†Øª:</b> ${input}</p>`;
    document.getElementById("chat-input").value="";
    try{
      let res=await fetch("https://api.openai.com/v1/chat/completions",{
        method:"POST",
        headers:{
          "Content-Type":"application/json",
          "Authorization":"Bearer Ù…ÙØªØ§Ø­_API_Ø¯ÙŠØ§Ù„Ùƒ"
        },
        body:JSON.stringify({
          model:"gpt-3.5-turbo",
          messages:[{role:"user",content:input}]
        })
      });
      let out=await res.json();
      let reply=out.choices[0].message.content;
      document.getElementById("chat-messages").innerHTML+=`<p><b>ğŸ¤–:</b> ${reply}</p>`;
    }catch(e){
      document.getElementById("chat-messages").innerHTML+=`<p style="color:red;">Ø®Ø·Ø£: ØªØ­Ù‚Ù‚ Ù…Ù† API</p>`;
    }
  }

  // Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
  showSection("pharmacies");
</script>
</body>
</html>
